<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bol AI - Advanced App Maker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="bg-[#0f172a] text-slate-200 min-h-screen p-4 md:p-10">

    <div class="max-w-5xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500 mb-2">Bol AI App Generator</h1>
            <p class="text-slate-400">अपनी डिटेल्स भरें और प्रोफेशनल एंड्रॉइड सोर्स कोड डाउनलोड करें</p>
        </header>

        <div class="glass border border-slate-700 rounded-3xl p-6 md:p-8 shadow-2xl">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <!-- App Name Input -->
                <div>
                    <label class="block text-sm font-semibold mb-2 text-green-400">App Name (एप्लीकेशन का नाम)</label>
                    <input type="text" id="appName" placeholder="My Awesome App" class="w-full bg-slate-900 border border-slate-700 rounded-xl p-3 outline-none focus:border-green-500 transition-all">
                </div>
                <!-- Package Name Input -->
                <div>
                    <label class="block text-sm font-semibold mb-2 text-green-400">Package Name (पैकेज का नाम)</label>
                    <input type="text" id="packageName" placeholder="com.company.myapp" class="w-full bg-slate-900 border border-slate-700 rounded-xl p-3 outline-none focus:border-green-500 transition-all">
                </div>
            </div>

            <!-- HTML Editor -->
            <div class="mb-6">
                <label class="block text-sm font-semibold mb-2 text-green-400">Index.html Code</label>
                <textarea id="userHtml" class="w-full h-64 bg-slate-900 border border-slate-700 rounded-xl p-4 font-mono text-sm text-blue-300 outline-none focus:border-green-500" placeholder="Paste your HTML, CSS, JS code here..."></textarea>
            </div>

            <button onclick="buildProject()" id="btn" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-4 rounded-xl shadow-lg transform active:scale-95 transition-all text-lg">
                Generate Full Source Code (ZIP)
            </button>

            <div id="status" class="mt-4 text-center hidden">
                <span class="inline-flex items-center px-4 py-2 font-semibold leading-6 text-sm shadow rounded-md text-white bg-slate-800 transition ease-in-out duration-150">
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Processing... Please Wait...
                </span>
            </div>
        </div>
    </div>

    <script>
        function buildProject() {
            const appName = document.getElementById('appName').value || "BolAiApp";
            const pkg = document.getElementById('packageName').value || "com.myapp.bol.ai.maker";
            const userHtml = document.getElementById('userHtml').value || "<h1>Hello World</h1>";
            const btn = document.getElementById('btn');
            const status = document.getElementById('status');

            if(!pkg.includes('.')) { alert("Package name format incorrect! (e.g. com.test.app)"); return; }

            btn.style.display = 'none';
            status.classList.remove('hidden');

            const zip = new JSZip();
            const pkgPath = pkg.replace(/\./g, '/');

            // --- 1. ROOT FILES ---
            zip.file("build.gradle", `buildscript {\n    repositories { google(); mavenCentral() }\n    dependencies { classpath 'com.android.tools.build:gradle:8.12.0' }\n}\nallprojects { repositories { google(); mavenCentral() } }`);
            zip.file("settings.gradle", `include ':app'`);
            zip.file("gradle.properties", `android.useAndroidX=true\nandroid.enableJetifier=true`);

            const app = zip.folder("app");
            app.file("build.gradle", `plugins { id 'com.android.application' }\nandroid {\n    compileSdk 34\n    namespace "${pkg}"\n    defaultConfig {\n        applicationId "${pkg}"\n        minSdkVersion 21\n        targetSdkVersion 34\n        versionCode 1\n        versionName "1.0"\n    }\n}`);

            const src = app.folder("src").folder("main");

            // --- 2. ANDROID MANIFEST ---
            src.file("AndroidManifest.xml", `<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <application android:name=".BolAiAppMakermain" android:label="${appName}" android:theme="@android:style/Theme.Material.Light.NoActionBar" android:allowBackup="true" android:icon="@mipmap/ic_launcher">
        <activity android:name=".MainActivity" android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
    </application>
</manifest>`);

            // --- 3. ASSETS ---
            src.folder("assets").file("index.html", userHtml);

            // --- 4. JAVA CLASSES ---
            const java = src.folder("java").folder(pkgPath);

            // MainActivity.java
            java.file("MainActivity.java", `package ${pkg};
import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.os.Bundle;
import android.webkit.*;
import android.widget.Toast;

public class MainActivity extends Activity {
    private WebView webview1;
    @Override
    protected void onCreate(Bundle _savedInstanceState) {
        super.onCreate(_savedInstanceState);
        webview1 = new WebView(this);
        WebSettings webSettings = webview1.getSettings();
        webSettings.setJavaScriptEnabled(true);
        webSettings.setDomStorageEnabled(true);
        webSettings.setAllowFileAccess(true);
        
        webview1.addJavascriptInterface(new Object() {
            @JavascriptInterface
            public void showToast(String msg) {
                Toast.makeText(MainActivity.this, msg, Toast.LENGTH_SHORT).show();
            }
        }, "JSInterface");

        webview1.setWebViewClient(new WebViewClient());
        setContentView(webview1);
        webview1.loadUrl("file:///android_asset/index.html");
    }
}`);

            // BolAiAppMakermain.java
            java.file("BolAiAppMakermain.java", `package ${pkg};
import android.app.Application;
import android.content.Context;

public class BolAiAppMakermain extends Application {
    private static Context mApplicationContext;
    @Override
    public void onCreate() {
        super.onCreate();
        mApplicationContext = getApplicationContext();
    }
    public static Context getContext() { return mApplicationContext; }
}`);

            // FileUtil & SketchwareUtil (Package name replaced)
            java.file("FileUtil.java", `package ${pkg};\nimport android.content.Context;\npublic class FileUtil { /* Utility Code */ }`);
            java.file("SketchwareUtil.java", `package ${pkg};\nimport android.content.Context;\nimport android.widget.Toast;\npublic class SketchwareUtil {\n    public static void showMessage(Context c, String s) { Toast.makeText(c, s, Toast.LENGTH_SHORT).show(); }\n}`);

            // --- 5. RESOURCES ---
            const res = src.folder("res");
            res.folder("values").file("strings.xml", `<resources><string name="app_name">${appName}</string></resources>`);
            res.folder("layout").file("main.xml", `<?xml version="1.0" encoding="utf-8"?>\n<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent" android:layout_height="match_parent" />`);

            // --- 6. GENERATE ZIP ---
            zip.generateAsync({type:"blob"}).then(function(content) {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(content);
                link.download = appName.replace(/\s+/g, '_') + "_SourceCode.zip";
                link.click();
                
                btn.style.display = 'block';
                status.classList.add('hidden');
            });
        }
    </script>
</body>
</html>
