<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWB Project Generator</title>
    <!-- JSZip Library for creating the archive -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <style>
        :root {
            --primary: #6200ea;
            --bg: #f4f4f9;
            --text: #333;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 500px;
            text-align: center;
        }
        h1 {
            margin-bottom: 1.5rem;
            color: var(--primary);
        }
        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        input[type="file"] {
            width: 100%;
            padding: 10px;
            border: 2px dashed #ccc;
            border-radius: 8px;
            cursor: pointer;
        }
        input[type="file"]:hover {
            border-color: var(--primary);
        }
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1rem;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
            font-weight: bold;
        }
        button:hover {
            background-color: #3700b3;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .status {
            margin-top: 15px;
            font-size: 0.9rem;
            color: #666;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>SWB Generator</h1>
    <p>Upload your assets to generate the <b>.swb</b> file.</p>

    <div class="form-group">
        <label for="appIcon">1. App Icon (Image)</label>
        <input type="file" id="appIcon" accept="image/*">
    </div>

    <div class="form-group">
        <label for="indexHtml">2. Index HTML File</label>
        <input type="file" id="indexHtml" accept=".html">
    </div>

    <button id="generateBtn" onclick="generateSWB()">Download .swb</button>
    <div class="status" id="status"></div>
</div>

<script>
    // --- STATIC DATA FROM YOUR ZIP FILE ---
    // These files will remain exactly the same in every download.

    const file_project_config = `{"min_sdk":"26","enable_bridgeless_themes":"false","enable_viewbinding":"false","app_class":".BolAiAppMakermain","target_sdk":"35","disable_old_methods":"false"}`;
    
    const file_permission = `["android.permission.INTERNET","android.permission.WRITE_EXTERNAL_STORAGE","android.permission.READ_EXTERNAL_STORAGE"]`;
    
    const file_icon_data_json = `{"textures":false,"selected_texture":0,"scale":1.0,"corners":60.0,"gradient_background_type":false,"icon_size":250.0,"text":"","badge_text_color":16777215,"gradient_direction":"BOTTOM_TOP","score_effect":false,"icon_hp":0.0,"gradient_color2":0,"gradient_color1":16777215,"rotation":150.0,"text_hp":0.0,"badge_bg_color":0,"texture_color":16777215,"icon_vp":0.0,"text_vp":0.0,"badge":"","background_color":16777215,"text_size":100.0,"adaptive_icon":false,"text_color":0,"opacity":180.0,"icon_color_filter":16777215}`;
    
    const file_proguard_rules = `-repackageclasses
-ignorewarnings
-dontwarn
-dontnote`;

    const file_proguard = `{"debug":"false","enabled":"false"}`;
    
    const file_stringfog = `{"enabled":"false"}`;
    
    const file_local_library = ``; // Empty file based on input
    
    const file_custom_blocks = `[]`;

    // --- GENERATION LOGIC ---

    async function generateSWB() {
        const iconInput = document.getElementById('appIcon');
        const htmlInput = document.getElementById('indexHtml');
        const status = document.getElementById('status');
        const btn = document.getElementById('generateBtn');

        // Validation
        if (!iconInput.files[0] || !htmlInput.files[0]) {
            alert("Please select both an App Icon and an index.html file.");
            return;
        }

        btn.disabled = true;
        status.innerText = "Generating .swb file...";

        try {
            const zip = new JSZip();

            // 1. Add Static Files (Exact content from your prompt)
            zip.file("data/project_config", file_project_config);
            zip.file("data/permission", file_permission);
            zip.file("data/files/app-icon/data.json", file_icon_data_json);
            zip.file("data/proguard-rules.pro", file_proguard_rules);
            zip.file("data/proguard", file_proguard);
            zip.file("data/stringfog", file_stringfog);
            zip.file("data/local_library", file_local_library);
            zip.file("data/custom_blocks", file_custom_blocks);

            // 2. Add User's HTML File
            // Replaces: data/files/assets/index.html
            const htmlContent = await readFile(htmlInput.files[0], 'text');
            zip.file("data/files/assets/index.html", htmlContent);

            // 3. Add User's Icon
            // Places it in: data/files/app-icon/icon.png (Standard naming for SWB)
            const iconContent = await readFile(iconInput.files[0], 'arraybuffer');
            // We rename whatever image they uploaded to 'icon.png' to ensure it works
            zip.file("data/files/app-icon/icon.png", iconContent);

            // 4. Generate and Download
            const content = await zip.generateAsync({type: "blob"});
            
            // Create download link
            const link = document.createElement('a');
            link.href = URL.createObjectURL(content);
            link.download = "project.swb"; // Force .swb extension
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            status.innerText = "Download started!";
        } catch (e) {
            console.error(e);
            status.innerText = "Error generating file. Check console.";
            alert("An error occurred.");
        } finally {
            btn.disabled = false;
        }
    }

    // Helper to read file content
    function readFile(file, type) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = reject;
            if (type === 'text') {
                reader.readAsText(file);
            } else {
                reader.readAsArrayBuffer(file);
            }
        });
    }
</script>

</body>
</html>
